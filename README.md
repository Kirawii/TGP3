# 基于多模型融合的个人信贷违约风险预测研究

## 概览 (Overview)

本项目旨在构建一个**融合深度特征工程与多模型集成**的端到端违约风险预测框架。面对普惠金融加速发展带来的信用风险显著增加的问题，本项目通过先进的机器学习技术，致力于建立一套科学、精准、高效的个人信贷违约风险预测体系。

本项目通过系统性的数据预处理和多维特征构建，成功克服了传统线性模型在处理**高维度、非线性**信贷数据时的局限性。最终的集成模型提供了优良的预测性能，并结合可解释性分析，为金融机构的风险管理决策提供支持。

比赛链接：https://tianchi.aliyun.com/competition/entrance/531830

## 贡献者 (Authors)

本项目为《数据挖掘》课程论文成果。

*   许桐恺 (42311038)
*   阙咏鑫 (42311056)
*   刘俊宏 (42311180)
*   **提交日期：** 2025 年 12 月 14 日

## 核心结果 (Key Results)
> **线上竞赛表现参考：** 本项目提出的建模框架在天池平台线上提交中取得约 **0.7400** 的 AUC 成绩，在 25805 支团队中排名第 **48** 名。

| 模型 | 验证集 AUC (Validation AUC) | 优势体现 |
| :--- | :--- | :--- |
| **Stacking 融合模型** | **0.753210** | 显著优于所有单一模型，证明融合策略的有效性。 |
| 单一 GBDT 模型（平均） | 约 0.745 | 远优于线性基线模型，展现非线性拟合能力。 |
| Logistic Regression (基线) | 约 0.727 | 作为对照基线，证明了 GBDT 模型的表达优势。 |

## 核心方法论与技术栈 (Methodology & Tech Stack)

### 1. 深度特征工程

特征工程是本项目性能提升的关键。构建了多维度的特征体系，旨在从数据交互中捕捉深层次的风险模式。

*   **数据预处理：** 对数值型缺失值填充 **-999**，分类缺失值填充 **MISSING**，将“缺失”本身作为一种信息模式纳入模型学习。有序变量（如 `grade`）被编码为连续数值（1-7）。
*   **目标编码 (Target Encoding)：** 针对 `postCode`、`employmentTitle` 等高基数类别特征，采用**外部多种子循环与内部 K-Fold 划分**计算折外均值，严格防止数据泄露。
*   **统计聚合与交叉特征：**
    *   构造匿名 `n` 系列特征的**行级别统计量**（均值、标准差、偏度等），捕捉用户宏观行为模式。
    *   构建**高阶交叉计数特征**（如 `grade_homeOwnership_term_count`），用于识别高度特定的细分人群风险模式。
*   **可解释性特征：** 构造具有明确业务含义的财务比率，如**月还款占月收入比** (`monthly_debt_to_income`) 和**贷款金额占收入比** (`loan_to_income_ratio`)。

### 2. 模型选择与优化

本项目选择了在表格数据上表现卓越的三大 GBDT 模型作为基学习器，并进行了系统优化。

*   **基学习器：** **XGBoost**、**LightGBM**、**CatBoost**。
*   **特征选择：** 基于 **XGBoost 的 Gain (增益) 特征重要性**排序，最终确定 Top **340 个特征**，以剔除冗余和噪音，确保泛化能力。
*   **超参数调优：** 采用 **Optuna** 自动化调优框架对所有基模型进行**贝叶斯优化**，以充分挖掘其性能上限。研究发现 `learning_rate` 和 `num_leaves`（对于 LightGBM）是影响模型性能的最关键因素。

### 3. 模型融合策略

为进一步提升预测的稳健性和准确性，采用了两种融合策略：

*   **简单平均融合：** 三个调优后的 GBDT 模型预测概率的算术平均值。
*   **Stacking 堆叠融合：**
    *   第一层（基模型）：XGBoost, LightGBM, CatBoost (使用 OOF 预测结果)。
    *   第二层（元模型）：**逻辑回归 (Logistic Regression)**，用于学习基模型的最佳组合权重。

### 4. 可解释性分析 (SHAP)

利用 **SHAP 值**对基学习器进行全局特征贡献分析，为模型的落地提供决策依据。

*   **核心影响因素：** 信用等级 (`grade`, `subGrade`)、时间特征 (`issueDate_day`) 以及**基于目标编码构造的职业/地区特征** (`employmentTitle_target_mean`, `postCode_target_mean`) 是驱动模型决策的关键因素。
*   **决策逻辑：** 信用等级越差（特征值越高），SHAP 值越偏正，模型预测违约的倾向性越高。
*   **模型一致性：** 三个基模型在特征重要性排序上表现出较高的一致性。
